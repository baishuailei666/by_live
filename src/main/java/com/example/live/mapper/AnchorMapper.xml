<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.live.mapper.AnchorMapper">

    <insert id="batchIns">
        INSERT
        INTO
        anchor(nickname, img, author_id, gender, `level`, fans, url, category, goods, sales
        , introduce, live, live_day, `view`, avg_dur, rate, avg_gmv, price, score)
        VALUES
        <foreach collection="list" item="anchor" index="index" separator=",">
            (#{anchor.nickname}, #{anchor.img}, #{anchor.authorId}, #{anchor.gender}, #{anchor.level}, #{anchor.fans},
            #{anchor.url}, #{anchor.category}, #{anchor.goods}, #{anchor.sales}, #{anchor.introduce}, #{anchor.live},
            #{anchor.liveDay}, #{anchor.view}, #{anchor.avgDur}, #{anchor.rate}, #{anchor.avgGmv}, #{anchor.price},
            #{anchor.score})
        </foreach>
    </insert>

    <select id="anchorList" resultType="com.example.live.entity.Anchor">
        select id
             , nickname
             , img
             , fans
             , category
             , goods
             , sales
        from anchor
        where 1=1
        <if test="category!=null and category!=''">
             and category like CONCAT('%',#{category},'%')
        </if>
        limit #{index},10
    </select>

    <select id="anchorListCount" resultType="int">
        select count(1)
        from anchor
        where 1=1
        <if test="category!=null and category!=''">
            and category like CONCAT('%',#{category},'%')
        </if>
    </select>

    <select id="anchorCollect" resultType="com.example.live.entity.Anchor">
        select a.id as id
             , a.nickname as nickname
             , a.img as img
             , a.author_id as authorId
             , a.gender as gender
             , a.level as level
             , a.fans as fans
             , a.url as url
             , a.category as category
             , a.goods as goods
             , a.sales as sales
             , a.introduce as introduce
             , a.live as live
             , a.live_day as liveDay
             , a.view as view
             , a.avg_dur as avgDur
             , a.rate as rate
             , a.price as price
             , a.score as score
             , ma.add as `add`
        from anchor a
                 left join merchant_anchor ma on ma.anchor_id = a.id
        where ma.merchant_id = #{merchantId}
    </select>

</mapper>
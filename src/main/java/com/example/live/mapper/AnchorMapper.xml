<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.live.mapper.AnchorMapper">

    <insert id="batchIns">
        INSERT
        INTO
        anchor(nickname, img, author_id, gender, `level`, fans, url, category, goods, sales
        , introduce, live, live_day, `view`, avg_dur, rate, avg_gmv, price, score)
        VALUES
        <foreach collection="list" item="anchor" index="index" separator=",">
            (#{anchor.nickname}, #{anchor.img}, #{anchor.authorId}, #{anchor.gender}, #{anchor.level}, #{anchor.fans},
            #{anchor.url}, #{anchor.category}, #{anchor.goods}, #{anchor.sales}, #{anchor.introduce}, #{anchor.live},
            #{anchor.liveDay}, #{anchor.view}, #{anchor.avgDur}, #{anchor.rate}, #{anchor.avgGmv}, #{anchor.price},
            #{anchor.score})
        </foreach>
    </insert>

    <select id="anchorList" resultType="com.example.live.entity.Anchor">
        --         select id, nickname, img, author_id as authorId, gender, level, fans, url
--              , category, goods, sales, introduce, live, live_day as liveDay, view, avg_dur as avgDur
--              , rate, price, score
--         from anchor
        select id
             , nickname
             , img
             , fans
             , category
             , goods
             , sales
        from anchor
        where 1=1
        <if test="category!=null and category!=''">
             and category like CONCAT('%',#{category},'%')
        </if>
        limit #{index},10
    </select>

    <select id="anchorListCount" resultType="int">
        select count(1)
        from anchor
        where 1=1
        <if test="category!=null and category!=''">
            and category like CONCAT('%',#{category},'%')
        </if>
    </select>

    <select id="anchorCollect" resultType="com.example.live.entity.Anchor">
        select a.id
             , a.nickname
             , a.img
             , a.author_id as a.authorId, a.gender
             , a.level
             , a.fans
             , a.url
             , a.category
             , a.goods
             , a.sales
             , a.introduce
             , a.live
             , a.live_day as liveDay
             , a.view
             , a.avg_dur  as avgDur
             , a.rate
             , a.price
             , a.score
        from anchor a
                 left join merchant_anchor ma on ma.anchor_id = a.id
        where ma.merchant_id = #{merchantId}
    </select>

</mapper>